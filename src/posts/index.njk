---
layout: base.njk
title: All Posts
---

<h1>All Posts</h1>

<section class="post-feed">
  {% for post in collections.posts | reverse %}
  {% set supa = supabasePosts | selectattr("slug", "equalto", post.data.slug) | first %}
  <article class="post-entry">
    <a href="{{ post.url }}" class="post-link">
      <div class="post-card">
        {% set isGated = post.data.access_level != "public" %}
        {% if isGated and user.access_level != post.data.access_level %}
        <div class="blurred-post">
          <img src="{{ post.data.images[0] }}" alt="{{ post.data.title }}" class="blurred-thumb">
          <div class="overlay">
            <span class="access-label">{{ post.data.access_level | capitalize }} Only</span>
            <a href="/login/" class="access-button">Log In to View</a>
          </div>
        </div>
        {% else %}
        <div class="post-thumb-wrapper">
          {% set altText = post.data.alt or post.data.title %}
          {% if supa and supa.image_url %}
          <img
            src="{{ supa.image_url }}"
            alt="{{ altText }}"
            class="post-thumb"
            loading="lazy"
          />
          {% elif post.data.images %}
          <img
            src="{{ post.data.images[0] }}"
            alt="{{ altText }}"
            class="post-thumb"
            loading="lazy"
          />
          {% endif %}
          {% if post.data.images and post.data.images.length > 1 %}
          <div class="more-indicator">+{{ post.data.images.length - 1 }}</div>
          {% endif %}
        </div>

        <div class="post-caption">
          <p>{{ post.data.caption }}</p>
          <small>{{ post.date | date("yyyy-MM-dd") }}{% if post.data.mood %} Â· {{ post.data.mood }}{% endif %}</small>
        </div>
        {% endif %}
      </div>
    </a>
  </article>
  {% endfor %}
</section>